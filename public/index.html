<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GroceryBucket</title>
    <link rel="shortcut icon" href="assets/favIcon.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
          background: linear-gradient(to right, rgb(2, 39, 32), 55%, rgb(11, 109, 59) 80%);
          color: white;
        }
    
        header{
          background-color:  rgb(2, 39, 32);
          position: sticky; 
          top: 0;
          z-index: 1000;
          width: 100%; 
        }
    
        #lp-div1 {
          margin-top: 10%;
        }
    
        #btn-category button {
          margin: 5px;
        }
    
        #img-category img {
          margin: 1%;
          border-radius: 20px;
        }
    
        #card-group {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          justify-content: center;
        }
    
        .card {
          width: 150px;
          height: 270px;
          margin: 5px;
        }
    
        #card-img {
          height: 100px;
          width: 90px;
        }
    
        #body-text {
          font-size: 11px;
        }
    
        #title {
          font-size: smaller;
          font-weight: bold;
          margin-bottom: -1px;
        }
    
        .card-header {
          background-color: white;
          padding: 0%;
        }
    
        .card-body {
          height: 50px;
          margin-bottom: -1px;
        }
    
        .card-footer {
          margin-top: -1px;
        }
    
        #btn-add {
          height: 25px;
          width: 55px;
          font-size: 14px;
        }
    
        .overflow-hidden-text {
          display: -webkit-box;
          line-clamp: 2;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
          text-overflow: ellipsis;
        }
    
        #img-category img:hover{
          cursor: pointer;
          box-shadow: 7px 7px 7px  rgba(248, 248, 255, 0.457);
          transform: scale(1.11);
        }
    
        #btnLogin a{
          text-decoration: none;
          color: black;
        }

        /* ADDED: Loading and error message styles */
        .loading-spinner {
          display: none;
          text-align: center;
          padding: 40px;
        }

        .error-message {
          display: none;
          background-color: #f8d7da;
          color: #721c24;
          padding: 15px;
          border-radius: 5px;
          margin: 20px;
          text-align: center;
        }

        /* ADDED: Quantity button styles */
        .qty-btn {
          width: 30px;
          height: 30px;
          padding: 0;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        @media  (max-width: 700px){
          #manImg{
            display: none;
          }
        }

        @media  (max-width: 400px){
          #manImg{
            display: none;
          }

          #img-category img {
            width: 180px;
            height: 120px;
          }

          #img-category{
            display: flex;
            flex-wrap: wrap !important;
            justify-content: space-evenly;
          }

          .card-header{
            height: 60px;
            width: 90px;
            margin-bottom: 4%;
          }

          .card-body{
            height: 40%;
            width: 100px;
          }

          .card-footer{
            height: 60px;
            width: 100px;
            display: flex;
            justify-content: space-around;
          }

          .card{
            height: 200px;
            width: 105px;
            margin-left: 0px;
            margin-right: 0px;
          }

          .type{
            display: none;
          }

          #card-img{
            height: 80px;
            width: 70px;
          }
          
          #addbtn{
            height: 30px;
            width: 51px;
            font-size: small;
            margin-left: 6px;
          }

          #btnLogin{
            display: flex;
            font-size: small;
            height: 40px;
          }
          
          #btnCart{
            display: block;
            font-size: small;
            height: 40px;
          }

          #card-group{
            margin-top: 60%;
          }

        }
#category, #lstOption {
    position: -webkit-sticky; /* Support for Safari */
    position: sticky;         /* The standard property */
    z-index: 100;
}

#category {
    top: 90px; /* Sticks when it hits 90px from the top of the window */
    background: transparent;
}


#lstOption {
    top: 140px; /* Adjust this value based on the height of your H2 title */
}
        
      </style>

     <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script>

// Configuration
const API_BASE_URL = 'https://imposterapi-5.onrender.com/data';

// Utility function to escape HTML and prevent XSS
function escapeHtml(text) {
  if (!text) return '';
  const map = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#039;'
  };
  return text.toString().replace(/[&<>"']/g, m => map[m]);
}

$(function () {

  let currentPage = 1;
  const limit = 28;
  let totalPages = 1; // FIXED: Changed from 28 to 1
  let allProducts = [];
  
  // FIXED: Track current category and subCategory for pagination
  let currentCategory = 'all';
  let currentSubCategory = 'all';

  function fetchProducts(page = 1, category = 'all', subCategory = 'all') {
    // FIXED: Save current category and subCategory for pagination
    currentCategory = category;
    currentSubCategory = subCategory;
    
    let url = `${API_BASE_URL}`;
    
    if (category !== 'all') {
      url += `/category/${category}`;
      if (subCategory !== 'all') {
        url += `/sub-category/${subCategory}`; 
      }
    }

    // FIXED: Show loading spinner
    $('#loading-spinner').show();
    $('#error-message').hide();
    $('#card-group').hide();

    $.ajax({
      url: url,
      method: 'GET',
      dataType: 'json',
      success: function(response) {
        if (Array.isArray(response)) {
          allProducts = response;
          totalPages = Math.ceil(allProducts.length / limit);
        } else {
          allProducts = response.data || [];
          totalPages = response.totalPages || 1;
        }
        
        // Slice for current page
        const start = (page - 1) * limit;
        const end = start + limit;
        const pageProducts = allProducts.slice(start, end);
        
        $('#card-group').empty();
        pageProducts.forEach(function(value) {
          const card = $(`
            <div class="col">
              <div class="card" style="cursor:pointer;">
                <div align="center" class="card-header">
                  <img id="card-img" src="${escapeHtml(value.image)}" class="card-img-top" alt="${escapeHtml(value.title)}">
                </div>
                <div class="card-body">
                  <p id="title" class="overflow-hidden-text fw-bold">${escapeHtml(value.title)}</p>
                  <p id="body-text" class="ms-1">Unit: ${escapeHtml(value.unit)}</p>
                  <p class="type" id="body-text">Type: ${escapeHtml(value.type)}</p>
                </div>
                <div class="card-footer d-flex justify-content-between align-items-center">
                  <span>&#8377;&nbsp;${escapeHtml(value.price)}</span>
                  <button id="addbtn" onclick="AddToCart(${value.id})" class="btn btn-outline-success">Add</button>
                </div>
              </div>
            </div>
          `);
          card.on("click", function () {
            $('#modalImage').attr('src', escapeHtml(value.image));
            $('#modalTitle').text(value.title);
            $('#modalUnit').text("Unit: " + value.unit);
            $('#modalType').text("Type: " + value.type);
            $('#modalPrice').text("₹ " + value.price); // FIXED: Changed to .text() for consistency
            $('#modalDescription').text(value.description);
            $('#modalFSSAI').text(value.fssaiLicense);
            $('#modalOrigin').text(value.countryOfOrigin);
            $('#modalShelfLife').text(value.shelfLife);
            $('#productModal .add-to-cart-button').data('product-id', value.id);
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show();
          });
          $('#card-group').append(card);
        });

        totalPages = response.totalPages || totalPages;
        currentPage = page; // FIXED: Update currentPage BEFORE updatePaginationButtons
        updatePaginationButtons();

        // FIXED: Hide loading spinner and show content
        $('#loading-spinner').hide();
        $('#card-group').show();

        $("#card-group")[0].scrollIntoView();
        
      },
      error: function(xhr, status, error) {
        console.error("Error fetching data:", error);
        // FIXED: Show user-visible error message
        $('#loading-spinner').hide();
        $('#error-message').text('Failed to load products. Please try again later.').show();
      }
    });
  }

  // Event listener for category buttons
  $("#btn-category button").on("click", function () {
    const category = $(this).data("category") || "all";
    const subCategory = $(this).data("sub-category") || "all";
    currentPage = 1;
    fetchProducts(currentPage, category, subCategory);
  });

  // Event listener for image categories
  $("#img-category img").on("click", function () {
    const category = $(this).data("category") || "all";
    const subCategory = $(this).data("sub-category") || "all";
    currentPage = 1;
    fetchProducts(currentPage, category, subCategory);
  });

  // Event listener for the dropdown
  $("#lstOption").on("change", function() {
    const selectedCategory = $(this).val();
    currentPage = 1;
    fetchProducts(currentPage, selectedCategory, 'all');
  });

  // Initial load
  fetchProducts();

  $('#productModal').on('click', '.add-to-cart-button', function() {
    const productId = $(this).data('product-id');
    AddToCart(productId);
  });

  
  function updatePaginationButtons() {
    // Clear existing page buttons except prev and next
    $(".pagination .page-item:not(:first-child):not(:last-child)").remove();

    // Add page buttons
    for (let i = 1; i <= totalPages; i++) {
      const pageItem = $(`<li class="page-item"><a class="page-link" href="#">${i}</a></li>`);
      $(".pagination .page-item:last-child").before(pageItem);
    }

    // Set active and disabled
    $(".pagination .page-item").removeClass("active disabled");
    $(".pagination .page-item:nth-child(" + (currentPage + 1) + ")").addClass("active");

    $("#prevPage").toggleClass("disabled", currentPage === 1);
    $("#nextPage").toggleClass("disabled", currentPage === totalPages);
  }

  // Event listeners for pagination links
  $(".pagination").on("click", ".page-item a", function (e) {
    e.preventDefault();
    const clickedPage = $(this).text();
    if (!isNaN(clickedPage)) {
      // FIXED: Pass current category and subCategory to maintain filter
      fetchProducts(parseInt(clickedPage), currentCategory, currentSubCategory);
    } else if ($(this).attr("aria-label") === "Previous" && currentPage > 1) {
      // FIXED: Pass current category and subCategory to maintain filter
      fetchProducts(currentPage - 1, currentCategory, currentSubCategory);
    } else if ($(this).attr("aria-label") === "Next" && currentPage < totalPages) {
      // FIXED: Pass current category and subCategory to maintain filter
      fetchProducts(currentPage + 1, currentCategory, currentSubCategory);
    }
  });

  // Add IDs to the 'Previous' and 'Next' buttons
  $(".pagination .page-item:first-child a").attr("id", "prevPage");
  $(".pagination .page-item:last-child a").attr("id", "nextPage");

});


function ShowCartClick() {
    document.querySelector("tbody").innerHTML = "";
    let totalAmount = 0;

    for (var item of cartItems) {
        var tr = document.createElement("tr");
        var tdImage = document.createElement("td");
        var tdTitle = document.createElement("td");
        var tdQuantity = document.createElement("td");
        var tdPrice = document.createElement("td");
        var tdActions = document.createElement("td");

        tdTitle.innerHTML = item.title;
        
        // FIXED: Show total price for this item (price × quantity)
        const itemTotal = parseFloat(item.price) * item.quantity;
        tdPrice.innerHTML = `₹${itemTotal.toFixed(2)}`;
        
        // FIXED: Create quantity controls with +/- buttons
        tdQuantity.innerHTML = `
            <div class="d-flex align-items-center justify-content-center gap-2">
                <button class="btn btn-sm btn-outline-secondary qty-btn" onclick="decrementQuantity(${item.id})">-</button>
                <span class="fw-bold">${item.quantity}</span>
                <button class="btn btn-sm btn-outline-secondary qty-btn" onclick="incrementQuantity(${item.id})">+</button>
            </div>
        `;
        
        // FIXED: Add remove button
        tdActions.innerHTML = `
            <button class="btn btn-sm btn-danger" onclick="removeFromCart(${item.id})">
                <i class="bi bi-trash"></i>
            </button>
        `;

        var img = document.createElement("img");
        img.src = item.image;
        img.width = "100";
        img.height = "100";

        tdImage.appendChild(img);

        tr.appendChild(tdImage);
        tr.appendChild(tdTitle);
        tr.appendChild(tdQuantity);
        tr.appendChild(tdPrice);
        tr.appendChild(tdActions);

        document.querySelector("tbody").appendChild(tr);

        totalAmount += itemTotal;
    }

    // Add total row
    let trTotal = document.createElement("tr");
    trTotal.innerHTML = `
        <td colspan="4" style="text-align: right;"><strong>Total:</strong></td>
        <td><strong>₹${totalAmount.toFixed(2)}</strong></td>
    `;
    let tbody = document.querySelector("tbody");
    if (tbody) {
        tbody.appendChild(trTotal);
    }
}

// FIXED: Function to increment quantity
function incrementQuantity(id) {
    const item = cartItems.find(item => item.id === id);
    if (item) {
        item.quantity += 1;
        GetCartItemsCount();
        ShowCartClick(); // Refresh cart display
    }
}

// FIXED: Function to decrement quantity
function decrementQuantity(id) {
    const item = cartItems.find(item => item.id === id);
    if (item) {
        if (item.quantity > 1) {
            item.quantity -= 1;
            GetCartItemsCount();
            ShowCartClick(); // Refresh cart display
        } else {
            // If quantity is 1, remove the item
            removeFromCart(id);
        }
    }
}

// FIXED: Function to remove item from cart
function removeFromCart(id) {
    const index = cartItems.findIndex(item => item.id === id);
    if (index !== -1) {
        cartItems.splice(index, 1);
        GetCartItemsCount();
        ShowCartClick(); // Refresh cart display
        showToast("Item removed from cart");
    }
}


var cartItems = [];
var count = 0;

function GetCartItemsCount(){
  count = cartItems.reduce((sum, item) => sum + item.quantity, 0); // FIXED: Sum quantities
  let total = cartItems.reduce((sum, item) => sum + (parseFloat(item.price) * item.quantity), 0); // FIXED: Multiply by quantity
  document.getElementById("totalAmount").innerHTML = ` ₹${total.toFixed(2)} X ${count}`;
}


function AddToCart(id){
    // Check if item already exists in cart
    const existingItem = cartItems.find(item => item.id === id);
    
    if (existingItem) {
        // FIXED: Instead of blocking, increment quantity
        existingItem.quantity += 1;
        GetCartItemsCount();
        showToast("Item quantity increased!");
        return; 
    }

    fetch(`${API_BASE_URL}/${id}`)
    .then((response) => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then((data) => {
        // FIXED: Add quantity property to new items
        data.quantity = 1;
        cartItems.push(data);
        GetCartItemsCount();
        // FIXED: Show success feedback to user
        showToast("Item added to cart!");
    })
    .catch((error) => {
        console.error("Error adding item to cart:", error);
        // FIXED: Show error to user
        alert("Failed to add item to cart. Please try again.");
    });
}

// FIXED: Added toast notification function
function showToast(message) {
    const toast = $(`
        <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
            <div class="toast show" role="alert">
                <div class="toast-header">
                    <strong class="me-auto">Success</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            </div>
        </div>
    `);
    $('body').append(toast);
    setTimeout(() => toast.remove(), 3000);
}

// ==================== RAZORPAY PAYMENT INTEGRATION ====================

// Handle checkout button click
async function handleCheckout() {
    // Check if cart is empty
    if (cartItems.length === 0) {
        alert('Your cart is empty!');
        return;
    }

    // Calculate total amount
    const totalAmount = cartItems.reduce((sum, item) => sum + (parseFloat(item.price) * item.quantity), 0);

    try {
        // Step 1: Create order on backend
        const orderResponse = await fetch('/api/razorpay/create-order', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                amount: totalAmount,
                currency: 'INR',
                receipt: `order_${Date.now()}`
            })
        });

        const orderData = await orderResponse.json();

        if (!orderData.success) {
            throw new Error(orderData.error || 'Failed to create order');
        }

        // Step 2: Get Razorpay key
        const keyResponse = await fetch('/api/razorpay/key');
        const keyData = await keyResponse.json();

        // Step 3: Initialize Razorpay payment
        const options = {
            key: keyData.key,
            amount: orderData.order.amount,
            currency: orderData.order.currency,
            name: 'GroceryBucket',
            description: 'Grocery Items Purchase',
            order_id: orderData.order.id,
            handler: async function (response) {
                // Payment successful, verify on backend
                await verifyPayment(response);
            },
            prefill: {
                name: 'Customer Name',
                email: 'customer@example.com',
                contact: '9999999999'
            },
            theme: {
                color: '#ffc107'
            },
            modal: {
                ondismiss: function() {
                    console.log('Payment cancelled by user');
                }
            }
        };

        const razorpay = new Razorpay(options);
        razorpay.open();

    } catch (error) {
        console.error('Checkout error:', error);
        alert('Failed to initiate payment. Please try again.');
    }
}

// Verify payment on backend
async function verifyPayment(response) {
    try {
        const verifyResponse = await fetch('/api/razorpay/verify-payment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                razorpay_order_id: response.razorpay_order_id,
                razorpay_payment_id: response.razorpay_payment_id,
                razorpay_signature: response.razorpay_signature
            })
        });

        const verifyData = await verifyResponse.json();

        if (verifyData.success) {
            // Payment verified successfully
            showToast('Payment successful! Order placed.');
            
            // Clear the cart
            cartItems = [];
            GetCartItemsCount();
            
            // Close the cart modal
            const cartModal = bootstrap.Modal.getInstance(document.getElementById('cart'));
            if (cartModal) {
                cartModal.hide();
            }

            // Show success message
            setTimeout(() => {
                alert(`Payment Successful!\nPayment ID: ${verifyData.payment_id}\nOrder ID: ${verifyData.order_id}`);
            }, 500);

        } else {
            throw new Error(verifyData.error || 'Payment verification failed');
        }

    } catch (error) {
        console.error('Payment verification error:', error);
        alert('Payment verification failed. Please contact support with your payment details.');
    }
}

// ========================================================

    </script>
</head>
<body>

    <header>
        <div class="d-flex justify-content-between align-items-center p-3">
          <h2><img class="p-0 m-0" src="/assets/cartIcon.png" width="70px" alt="">GroceryBucket</h2>
          <div class="d-flex">
            <button id="btnLogin" class="btn btn-warning mx-2"><i class="bi bi-person-circle"></i><a href="./login.html">&nbsp;Login</a></button>
            <button id="btnCart" onclick="ShowCartClick()" data-bs-target="#cart" data-bs-toggle="modal" class="btn btn-warning mx-2"><i class="bi bi-cart3"></i>&nbsp;Cart
              </span>
              <span id="totalAmount" class="badge bg-success">
              </span>
            </button>
          </div>
        </div>
    </header>

    <section class="container-fluid">
        <div class="d-flex justify-content-around">
          <div id="lp-div1">
            <div align="center" style="color: white; border-radius: 20px; background-color: rgba(255, 255, 255, 0.075); width: 200px; font-size: small;"><i class="bi bi-truck"></i>&nbsp;&nbsp;Fastest Grocery Delivery</div>
            <div>
              <h1 style="font-weight: bolder;">Get fresh Grocery</h1>
              <h2 style="font-family: roboto;">Enjoy healthy life.</h2>
            </div>
            <div class="input-group">
              <input class="form-control" placeholder="search" type="text">
              <button class="btn btn-warning"><i class="bi bi-search"></i></button>
            </div>
            <p class="mb-0" style="color: rgba(255, 255, 255, 0.516); font-size: smaller;">Not yet Member?<a id="btn-signup" href="./signup.html">&nbsp;sign up&nbsp;</a>now</p>
            <img src="assets/4-removebg-preview.png" class="ms-5 mt-0" width="220px" height="250px" title="Hello">
          </div>
    
          <div class="mt-5">
            <img id="manImg" src="assets/grocery-banner-img.png" width="450px" alt="Grocery shopping banner">
          </div>
        </div>
    
        <div id="btn-category" class="mt-5" align="center">
          <button class="btn btn-warning px-4" data-category="fruit_veges">Fruits</button>
          <button class="btn btn-warning px-4" data-category="atta_rice">Atta</button>
          <button class="btn btn-warning px-4" data-category="dairy_breakfast" data-sub-category="eggs">Eggs</button>
          <button class="btn btn-warning" data-category="drinks">Beverages</button>
          <button class="btn btn-warning" data-category="personal_care" data-sub-category="facewash">Facewash</button>
          <button class="btn btn-warning px-4" data-category="dairy_breakfast" data-sub-category="milk">Milk</button>
          <button class="btn btn-warning" data-category="instant_food" data-sub-category="noodles">Noodles</button>
          <button class="btn btn-warning" data-category="dairy_breakfast" data-sub-category="cheese">Cheese</button>
          <button class="btn btn-warning " data-category="oil_masala" data-sub-category="oil">Oil</button>
          <button class="btn btn-warning" data-category="dairy_breakfast" data-sub-category="paneer">Paneer</button>
        </div>
        
    
        <div align="center" id="img-category">
          <img src="assets/AdobeStock_314327563_Preview.jpeg" data-category="fruit_veges" width="350px" height="180px" alt="Fresh fruits category" />
          <img src="assets/AdobeStock_335853623_Preview.jpeg" data-category="fruit_veges" data-sub-category="vegetable" width="350px" height="180px" alt="Fresh vegetables category" />
          <img src="assets/download.webp" data-category="instant_food" data-sub-category="veg_snack" width="350px" height="180px" alt="Instant food snacks category" />
        </div>

        <div class="row">
            <div class="col-md-2 d-none d-md-block">
              <h2 align="center" id="category">Category</h2>
              <select id="lstOption" class="form-select dropdown m-3">
                <option selected value="all">All</option>
                <option value="atta_rice">Atta&Rice</option>
                <option value="fruit_veges">Fruits&Vegetables</option>
                <option value="instant_food">Instant Food</option>
                <option value="dairy_breakfast">Dairy&Breakfast</option>
                <option value="drinks">Drinks</option>
                <option value="oil_masala">Oil&Masala</option>
                <option value="personal_care">Personal care</option>
              </select>
            </div>
      
            <div align="center" class="col-12 col-md-8">

              <!-- FIXED: Added loading spinner -->
              <div id="loading-spinner" class="loading-spinner">
                <div class="spinner-border text-warning" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3">Loading products...</p>
              </div>

              <!-- FIXED: Added error message -->
              <div id="error-message" class="error-message"></div>

              <div id="card-group">
                <!-- Product cards will be injected here -->
              </div>

              <div class="d-flex justify-content-center">
                <nav aria-label="Page navigation example">
                  <ul class="pagination">
                    <li class="page-item">
                      <a class="page-link" href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                      </a>
                    </li>
                    <!-- FIXED: Removed hardcoded page numbers 1, 2, 3 - JS will generate them -->
                    <li class="page-item">
                      <a class="page-link" href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>

            </div>
              
            <div class="col-2">
            </div>
        </div>

    </section>

    <!-- Product Modal -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content text-dark">
            <div class="modal-header">
              <h5 class="modal-title" id="productModalLabel">Product Info</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
              <div align="center">
                <img id="modalImage" width="300px" height="300px" class="img-fluid mb-2" alt="Product image" />
              </div>
              <h5 id="modalTitle"></h5>
              <p id="modalUnit"></p>
              <p id="modalType"></p>
              <p id="modalPrice" class="fw-bold"></p>
              <p id="modalDescription"></p>
              <p><strong>FSSAI:</strong> <span id="modalFSSAI"></span></p>
              <p><strong>Country:</strong> <span id="modalOrigin"></span></p>
              <div class="d-flex">
                <p><strong>Shelf Life:</strong> <span id="modalShelfLife"></span></p>
                <button class="btn btn-outline-success add-to-cart-button" style="margin-left: 60%;">Add</button>
              </div>
            </div>
          </div>
        </div>
    </div>

    <!-- CART MODAL -->
    <div class="modal fade" id="cart">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Your Cart</h3>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Title</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
          </div>
          <div class="modal-footer">
               <button class="btn btn-warning" onclick="handleCheckout()">Check Out</button>
          </div>
        </div>
      </div>
    </div> <!-- FIXED: Added missing closing div tag for modal -->

    <!-- Razorpay Checkout Script -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <!-- FIXED: Removed duplicate bootstrap.min.js, kept only bundle version -->
    <!-- FIXED: Moved scripts inside body tag -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
</body>
</html>